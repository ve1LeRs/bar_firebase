# üîí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—á–µ—Ç–æ–≤

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –∏–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—á–µ—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞:
```
FirebaseError: Missing or insufficient permissions.
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore –≤ Firebase Console.

## üìã –®–∞–≥–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ)

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **bar-menu-6145c**
3. –í –º–µ–Ω—é —Å–ª–µ–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ **Firestore Database**
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Rules** (–ü—Ä–∞–≤–∏–ª–∞)
5. –ù–∞–π–¥–∏—Ç–µ —ç—Ç—É —Å–µ–∫—Ü–∏—é –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö:

```javascript
match /{document=**} {
  // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º —á–∏—Ç–∞—Ç—å
  allow read: if true;
  
  // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å
  allow write: if true;
}
```

6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–∞ —Å–µ–∫—Ü–∏—è **–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ**, –ø–æ—Å–ª–µ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö `match` –ø—Ä–∞–≤–∏–ª
7. –ù–∞–∂–º–∏—Ç–µ **Publish** (–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ó–∞–º–µ–Ω–∏—Ç–µ –í–°–ï –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤
    match /orders/{orderId} {
      allow read: if true;
      allow create: if true;
      allow update: if true;
      allow delete: if true;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞
    match /stoplist/{itemId} {
      allow read: if true;
      allow write: if true;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Å—á–µ—Ç–æ–≤ (bills) - –ù–û–í–û–ï!
    match /bills/{billId} {
      // –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å—á–µ—Ç–∞
      allow read: if request.auth != null && 
                     (resource.data.userId == request.auth.uid || 
                      get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin');
      
      // –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—á–µ—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
      
      // –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–∏ —Å—á–µ—Ç–∞ –∏–ª–∏ –∞–¥–º–∏–Ω–∞–º
      allow update: if request.auth != null && 
                       (resource.data.userId == request.auth.uid || 
                        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin');
      
      // –†–∞–∑—Ä–µ—à–∏—Ç—å —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º
      allow delete: if request.auth != null && 
                       get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –æ—Ü–µ–Ω–æ–∫ (ratings) - –¥–ª—è –±—É–¥—É—â–µ–≥–æ
    match /ratings/{ratingId} {
      allow read: if true;
      allow create: if request.auth != null;
      allow update: if request.auth != null && resource.data.userId == request.auth.uid;
      allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
    match /{document=**} {
      allow read: if true;
      allow write: if true;
    }
  }
}
```

### –®–∞–≥–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **bar-menu-6145c**
3. Firestore Database ‚Üí Rules
4. **–£–¥–∞–ª–∏—Ç–µ –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞**
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ** –ø—Ä–∞–≤–∏–ª–∞ –≤—ã—à–µ
6. –ù–∞–∂–º–∏—Ç–µ **Publish**

## ‚ö†Ô∏è –í–∞–∂–Ω–æ!

–ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª –ø–æ–¥–æ–∂–¥–∏—Ç–µ **1-2 –º–∏–Ω—É—Ç—ã**, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å.

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª:

1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (**Ctrl + Shift + R**)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
3. –ó–∞–∫–∞–∂–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
4. –ù–∞–∂–º–∏—Ç–µ **"–ú–æ–π —Å—á–µ—Ç"**

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ —Å—á–µ—Ç–æ–º –±–µ–∑ –æ—à–∏–±–æ–∫!

## üìù –ß—Ç–æ –¥–µ–ª–∞—é—Ç —ç—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞?

### –î–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `bills`:

- ‚úÖ **–ß–∏—Ç–∞—Ç—å** - —Ç–æ–ª—å–∫–æ —Å–≤–æ–π —Å—á–µ—Ç (–∏–ª–∏ –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ)
- ‚úÖ **–°–æ–∑–¥–∞–≤–∞—Ç—å** - —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–ª—è —Å–µ–±—è
- ‚úÖ **–û–±–Ω–æ–≤–ª—è—Ç—å** - —Ç–æ–ª—å–∫–æ —Å–≤–æ–π —Å—á–µ—Ç (–∏–ª–∏ –∞–¥–º–∏–Ω)
- ‚úÖ **–£–¥–∞–ª—è—Ç—å** - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —Å—á–µ—Ç–∞ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —á—É–∂–∏–µ —Å—á–µ—Ç–∞
- –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü —Å—á–µ—Ç–∞ –º–æ–∂–µ—Ç –µ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- –ê–¥–º–∏–Ω—ã –∏–º–µ—é—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

–ï—Å–ª–∏ —É –≤–∞—Å –≤—Å–µ –µ—â–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if true;
    }
  }
}
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

## üìû –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã —Ç–æ—á–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –ø—Ä–∞–≤–∏–ª–∞ (–∫–Ω–æ–ø–∫–∞ **Publish**)
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (**Ctrl + Shift + Delete**)
4. –ü–µ—Ä–µ–∑–∞–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (**F12**), –µ—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏

---

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª —Å–∏—Å—Ç–µ–º–∞ —Å—á–µ—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ

