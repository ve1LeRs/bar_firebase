# üåü –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–æ–∫—Ç–µ–π–ª–µ–π

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 1: –ó–∞–∫–∞–∂–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
3. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–∫–∞–∑–∞—Ç—å"
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–∫–∞–∑

### –®–∞–≥ 2: –î–æ–∂–¥–∏—Ç–µ—Å—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
–ë–∞—Ä–º–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–∫–∞–∑:
- ‚è≥ **Pending** (–í –æ–±—Ä–∞–±–æ—Ç–∫–µ)
- ‚úÖ **Confirmed** (–ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω)
- üë®‚Äçüç≥ **Preparing** (–ì–æ—Ç–æ–≤–∏—Ç—Å—è)
- üç∏ **Ready** (–ì–æ—Ç–æ–≤) ‚Üê –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ–∫–Ω–æ!

### –®–∞–≥ 3: –û—Ü–µ–Ω–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
–ö–æ–≥–¥–∞ —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "–ì–æ—Ç–æ–≤":
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
2. –í—ã –≤–∏–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–∫—Ç–µ–π–ª—è
3. –í—ã–±–∏—Ä–∞–µ—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ (1-5):
   - 1 ‚≠ê - –£–∂–∞—Å–Ω–æ
   - 2 ‚≠ê‚≠ê - –ü–ª–æ—Ö–æ
   - 3 ‚≠ê‚≠ê‚≠ê - –ù–æ—Ä–º–∞–ª—å–Ω–æ
   - 4 ‚≠ê‚≠ê‚≠ê‚≠ê - –•–æ—Ä–æ—à–æ
   - 5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê - –û—Ç–ª–∏—á–Ω–æ!
4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
5. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É" –∏–ª–∏ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"

### –®–∞–≥ 4: –†–µ–π—Ç–∏–Ω–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω
- ‚úÖ –û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ Firebase
- ‚úÖ –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ "Completed"
- ‚úÖ –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–æ–∫—Ç–µ–π–ª—è

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ (script.js)

```javascript
// –ü—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
firebase.auth().onAuthStateChanged(async (user) => {
  if (user) {
    startTrackingUserOrders(user.uid);
  }
});

// –§—É–Ω–∫—Ü–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
function startTrackingUserOrders(userId) {
  // Real-time —Å–ª—É—à–∞—Ç–µ–ª—å Firebase
  userOrdersListener = db.collection('orders')
    .where('userId', '==', userId)
    .onSnapshot((snapshot) => {
      snapshot.docChanges().forEach((change) => {
        const order = change.doc.data();
        const orderId = change.doc.id;
        
        // –ï—Å–ª–∏ –∑–∞–∫–∞–∑ —Å—Ç–∞–ª –≥–æ—Ç–æ–≤
        if (change.type === 'modified' && order.status === 'ready') {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –æ—Ü–µ–Ω–∫–∏
          showRatingModal(orderId, order.cocktailName);
        }
      });
    });
}
```

### 2. –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ü–µ–Ω–∫–∏ (index.html)

```html
<div id="ratingModal" class="modal rating-modal">
  <div class="modal-content rating-modal-content">
    <div class="rating-header">
      <div class="rating-emoji">üç∏</div>
      <h3>–û—Ü–µ–Ω–∏—Ç–µ –≤–∞—à –∫–æ–∫—Ç–µ–π–ª—å</h3>
      <p id="ratingCocktailName">–ú–æ—Ö–∏—Ç–æ</p>
    </div>
    
    <div class="rating-body">
      <p class="rating-question">–ö–∞–∫ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –∫–æ–∫—Ç–µ–π–ª—å?</p>
      
      <!-- 5 –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–≤–µ–∑–¥ -->
      <div class="stars-container">
        <i class="fas fa-star star" data-rating="1"></i>
        <i class="fas fa-star star" data-rating="2"></i>
        <i class="fas fa-star star" data-rating="3"></i>
        <i class="fas fa-star star" data-rating="4"></i>
        <i class="fas fa-star star" data-rating="5"></i>
      </div>
      
      <p class="rating-text">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É</p>
      
      <textarea id="ratingComment" 
                placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
      </textarea>
    </div>
    
    <div class="rating-footer">
      <button id="submitRating">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</button>
      <button id="skipRating">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
    </div>
  </div>
</div>
```

### 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏

```javascript
async function saveRating() {
  // –î–∞–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏
  const ratingData = {
    cocktailName: currentRatingData.cocktailName,
    rating: selectedRating,            // 1-5
    comment: ratingComment.value || null,
    userId: currentUser.uid,
    userName: currentUser.displayName,
    orderId: currentRatingData.orderId,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  };
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
  await db.collection('ratings').add(ratingData);
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
  await db.collection('orders').doc(orderId).update({
    status: 'completed',
    rated: true,
    ratingValue: selectedRating
  });
}
```

### 4. –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞

```javascript
async function getCocktailAverageRating(cocktailName) {
  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –æ—Ü–µ–Ω–∫–∏ —ç—Ç–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è
  const ratingsSnapshot = await db.collection('ratings')
    .where('cocktailName', '==', cocktailName)
    .get();
  
  let totalRating = 0;
  let count = 0;
  
  ratingsSnapshot.forEach(doc => {
    const rating = doc.data();
    totalRating += rating.rating;
    count++;
  });
  
  const averageRating = totalRating / count;
  
  return {
    average: averageRating,  // –ù–∞–ø—Ä–∏–º–µ—Ä: 4.5
    count: count             // –ù–∞–ø—Ä–∏–º–µ—Ä: 12
  };
}
```

### 5. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö

```javascript
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–∫—Ç–µ–π–ª–µ–π
async function loadCocktails() {
  cocktailsSnapshot.forEach(doc => {
    const cocktail = doc.data();
    const cocktailCard = createCocktailCard(cocktail);
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥
    getCocktailAverageRating(cocktail.name).then(ratingData => {
      if (ratingData) {
        displayCocktailRating(cocktailCard, ratingData);
      }
    });
  });
}

function displayCocktailRating(cardElement, ratingData) {
  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–≤–µ–∑–¥—ã
  const fullStars = Math.floor(ratingData.average);
  const hasHalfStar = ratingData.average % 1 >= 0.5;
  
  let starsHtml = '';
  for (let i = 0; i < 5; i++) {
    if (i < fullStars) {
      starsHtml += '<i class="fas fa-star"></i>';      // –ü–æ–ª–Ω–∞—è ‚≠ê
    } else if (i === fullStars && hasHalfStar) {
      starsHtml += '<i class="fas fa-star-half-alt"></i>'; // –ü–æ–ª–æ–≤–∏–Ω–∞ ‚≠ê
    } else {
      starsHtml += '<i class="far fa-star"></i>';      // –ü—É—Å—Ç–∞—è ‚òÜ
    }
  }
  
  // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
  ratingBadge.innerHTML = `
    <div class="cocktail-rating-stars">${starsHtml}</div>
    <div class="cocktail-rating-value">${ratingData.average.toFixed(1)}</div>
    <div class="cocktail-rating-count">(${ratingData.count})</div>
  `;
}
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Firebase

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `ratings`

```json
{
  "cocktailName": "–ú–æ—Ö–∏—Ç–æ",
  "rating": 5,
  "comment": "–û—Ç–ª–∏—á–Ω—ã–π –∫–æ–∫—Ç–µ–π–ª—å! –û—á–µ–Ω—å –æ—Å–≤–µ–∂–∞—é—â–∏–π",
  "userId": "abc123",
  "userName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "orderId": "order456",
  "createdAt": "2025-10-08T10:30:00Z"
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ `orders`

```json
{
  "cocktailName": "–ú–æ—Ö–∏—Ç–æ",
  "status": "completed",
  "rated": true,
  "ratingValue": 5,
  ...
}
```

---

## üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

### –ê–Ω–∏–º–∞—Ü–∏–∏ –∑–≤–µ–∑–¥
```css
.star:hover {
  transform: scale(1.2) rotate(10deg);
}

.star.active {
  color: #ffd700;
  transform: scale(1.15);
  animation: starPulse 0.5s ease-out;
  filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
}
```

### –ü–æ—è–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
```css
@keyframes ratingModalAppear {
  0% {
    opacity: 0;
    transform: scale(0.8) translateY(30px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}
```

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
// –°–∏–º—É–ª—è—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "ready"
const testOrder = {
  id: 'test123',
  cocktailName: '–ú–æ—Ö–∏—Ç–æ',
  userId: firebase.auth().currentUser.uid,
  status: 'ready'
};

showRatingModal('test123', '–ú–æ—Ö–∏—Ç–æ');
```

### –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:

1. **–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**
   - –ó–∞–∫–∞–∂–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
   - –î–æ–∂–¥–∏—Ç–µ—Å—å –∫–æ–≥–¥–∞ –±–∞—Ä–º–µ–Ω –∏–∑–º–µ–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ "–ì–æ—Ç–æ–≤"
   - –û–∫–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

2. **–ö–∞–∫ –∞–¥–º–∏–Ω (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞):**
   - –ó–∞–∫–∞–∂–∏—Ç–µ –∫–æ–∫—Ç–µ–π–ª—å
   - –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É
   - –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π –∑–∞–∫–∞–∑
   - –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –Ω–∞ "–ì–æ—Ç–æ–≤"
   - –û–∫–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ!

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [x] –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ü–µ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω–æ
- [x] –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–≤–µ–∑–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –≤ Firebase
- [x] –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
- [x] –ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
- [x] –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û–∫–Ω–æ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è?

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é:**
   ```javascript
   console.log('Current user:', firebase.auth().currentUser);
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞:**
   ```javascript
   db.collection('orders').doc('ORDER_ID').get()
     .then(doc => console.log('Order status:', doc.data().status));
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª—É—à–∞—Ç–µ–ª—å:**
   ```javascript
   console.log('User orders listener:', userOrdersListener);
   ```

### –†–µ–π—Ç–∏–Ω–≥ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ?

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –æ—Ü–µ–Ω–æ–∫:**
   ```javascript
   db.collection('ratings')
     .where('cocktailName', '==', '–ú–æ—Ö–∏—Ç–æ')
     .get()
     .then(snapshot => console.log('Ratings count:', snapshot.size));
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—á–µ—Ç:**
   ```javascript
   getCocktailAverageRating('–ú–æ—Ö–∏—Ç–æ')
     .then(rating => console.log('Average rating:', rating));
   ```

---

## üìö –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã

- **HTML:** `index.html` (—Å—Ç—Ä–æ–∫–∏ 397-426) - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- **CSS:** `style.css` (—Å—Ç—Ä–æ–∫–∏ 6635-7095) - –°—Ç–∏–ª–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
- **JS:** `script.js` (—Å—Ç—Ä–æ–∫–∏ 5944-6265) - –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- **Docs:** `RATING_SYSTEM_GUIDE.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Docs:** `–°–ò–°–¢–ï–ú–ê_–û–¶–ï–ù–û–ö_–ö–û–ö–¢–ï–ô–õ–ï–ô.md` - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

---

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!** üéâ

